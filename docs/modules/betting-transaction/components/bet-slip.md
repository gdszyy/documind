---
id: bet-slip
type: component
title: 投注栏
description: 管理用户的投注选择、待结算和已结算的注单
status: revised
owner: 李四
tags: [投注, 全局组件, 核心功能]
componentType: global
createdAt: 2025-12-07
updatedAt: 2025-12-07
version: 3.0.0
---

# 投注栏 `[全局组件]`

## 1. 组件概述

投注栏是一个全局组件，固定在页面右侧或底部，是用户管理所有投注活动的核心枢纽。它不仅包含用户当前选择的投注项（注单），还集成了待结算（Open）和已结算（Settled）的投注历史记录。

**核心功能**:
- **注单管理 (Slip Tab)**: 添加/删除注单，支持单关/串关模式切换，输入投注额并提交。
- **待结算注单 (Open Tab)**: 查看已提交但尚未结算的注单列表。
- **已结算注单 (Settled Tab)**: 查看已完成结算的注单及其结果（赢/输）。
- **异常处理**: 通过调用`模态消息`和`Toast`组件处理赔率变化、盘口关闭、余额不足等情况。

---

## 2. 组件状态与变体

投注栏的核心交互通过三个Tab页面来组织：`Slip`、`Open` 和 `Settled`。

### 2.1. Tab 结构

| Tab 名称 | 英文 ID | 功能描述 |
| :--- | :--- | :--- |
| **注单** | `slip` | 用户当前选择的、尚未提交的投注项。所有投注操作在此完成。 |
| **待结算** | `open` | 用户已提交但比赛尚未结束的注单。此列表为只读状态。 |
| **已结算** | `settled` | 用户已结算的注单，显示输赢结果。提供跳转到完整历史页面的入口。 |

### 2.2. Slip Tab (注单)

这是投注栏的默认和主要视图，包含以下状态：

- **空状态**: 
  - **描述**: `slip` Tab内没有任何投注项。
  - **显示**: 提示“您的注单是空的”，并引导用户去选择盘口。
  - **交互**: 通过调用 `Toast` 组件提示“请先选择您要投注的赛事”。

- **单关模式**:
  - **描述**: 注单列表中只有一项时自动进入此模式。
  - **显示**: 注单信息、投注额输入框、预计奖金、提交按钮。

- **串关模式**:
  - **描述**: 注单列表中有两项或以上时自动进入此模式。
  - **显示**: 所有注单信息、串关类型选择器、总赔率、投注额输入框、提交按钮。

### 2.3. Open Tab (待结算)

- **描述**: 显示所有已提交但未结算的注单列表。
- **显示**: 按时间倒序排列的注单列表，每个注单项包含赛事信息、投注金额和预计奖金。
- **交互**: 列表为只读，用户可查看详情但不能修改。

### 2.4. Settled Tab (已结算)

- **描述**: 显示最近的已结算注单列表。
- **显示**: 按结算时间倒序排列的注单列表，每个注单项清晰地标明“赢”或“输”的状态及具体金额。
- **交互**: 
  - 列表为只读。
  - 在列表底部提供一个“查看所有历史记录”的按钮，点击后跳转到个人中心模块的完整投注历史页面。

---

## 3. 核心交互逻辑

### 3.1. 添加注单

- **逻辑**: 用户在`赛事卡片`或`盘口列表`点击一个盘口选项，该选项被添加到`slip` Tab的注单列表中。通过调用 `Toast` 组件提示“添加成功”。

### 3.2. 提交投注

- **逻辑**: 用户在`slip` Tab点击“提交投注”按钮。
  1.  系统进行最终验证（余额、盘口状态等）。
  2.  验证失败时，通过调用`模态消息`组件显示错误信息（如“余额不足”）。
  3.  验证成功后，调用`place-bet` API。
  4.  提交成功后，清空`slip` Tab，并通过`Toast`组件提示“投注成功”。该笔注单会出现在`open` Tab中。

### 3.3. 异常状态处理

- **赔率变化**: 
  - **处理方式**: 调用`模态消息`组件，标题为“赔率已变化”，内容为变化的盘口详情，提供“接受新赔率”和“移除注单”两个按钮。

- **盘口关闭**: 
  - **处理方式**: 调用`模态消息`组件，标题为“盘口已关闭”，内容为“您选择的盘口已关闭，请将其从注单中移除。”，并提供“确认”按钮。

- **余额不足**: 
  - **处理方式**: 调用`模态消息`组件，标题为“余额不足”，内容为“您的账户余额不足以完成本次投注。”，并提供“前往充值”和“关闭”两个按钮。

---

## 4. 调用的 API

- `place-bet`: 提交用户的投注单。
- `get-open-bets`: 获取待结算的注单列表。
- `get-settled-bets`: 获取已结算的注单列表。
- `get-user-balance`: 获取用户当前余额。

---

## 5. 变更历史

| 版本 | 日期 | 作者 | 变更内容 |
| :--- | :--- | :--- | :--- |
| 3.0.0 | 2025-12-07 | Manus AI | **重大重构**：引入`Slip`, `Open`, `Settled`三Tab结构，集成投注历史功能。移除独立的异常状态提示，改为调用`Modal`和`Toast`全局组件。 |
| 2.1.0 | 2024-01-15 | 李四 | 增加赔率变化提示功能。 |
| 1.0.0 | 2024-01-05 | 李四 | 初始版本，支持单关/串关模式。 |
