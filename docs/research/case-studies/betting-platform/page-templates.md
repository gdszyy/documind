# 页面文档模板

本文档提供了页面文档的标准化模板,基于 V2.0 方案的设计理念:**页面文档聚焦于组件装配和交互协同**。

---

## 一、页面文档模板

### 模板文件

**文件名**: `event-detail.md`

```markdown
---
id: event-detail
type: page
title: 赛事详情页
description: 用户查看单场比赛的详细盘口信息并进行投注
status: completed
owner: 张三
tags: [赛事, 盘口, 投注]
createdAt: 2024-01-10
updatedAt: 2024-01-15
version: 1.2.0
---

# 赛事详情页

## 基本信息

| 属性 | 值 |
|------|------|
| 页面 ID | `event-detail` |
| 路由 | `/events/:eventId` |
| 状态 | 已完成 |
| 负责人 | 张三 |
| 最后更新 | 2024-01-15 |
| 版本 | 1.2.0 |

---

## 用户故事

**作为** 一个体育博彩用户

**我想要** 查看单场比赛的详细盘口信息

**以便** 我可以选择合适的盘口进行投注

**验收标准**:
- 用户可以看到比赛的基本信息(主队、客队、比赛时间、联赛等)
- 用户可以看到所有可投注的盘口类型(胜平负、让球、大小球等)
- 用户可以点击盘口选项,将其添加到投注栏
- 用户可以看到盘口的实时赔率变化
- 用户可以查看比赛的统计数据和历史交锋记录

---

## 组件装配

本页面使用以下组件:

### 页面独有组件

- [@赛事信息](../components/event-info.md) `[组件]` - 显示比赛基本信息(主队、客队、时间、联赛)
- [@盘口列表](../components/odds-list.md) `[组件]` - 显示所有可投注的盘口选项
- [@赛事统计](../components/event-stats.md) `[组件]` - 显示比赛统计数据
- [@历史交锋](../components/head-to-head.md) `[组件]` - 显示两队历史交锋记录

### 全局组件

- [@投注栏](../components/bet-slip.md) `[全局组件]` - 管理投注单
- [@导航栏](../components/navbar.md) `[全局组件]` - 页面导航
- [@底部导航](../components/bottom-nav.md) `[全局组件]` - 移动端底部导航

---

## 页面自身状态

**注意**: 以下状态仅描述页面独有内容区域的状态,不包含全局组件(如投注栏、导航栏)的状态。

### 加载中

**描述**: 页面正在加载赛事数据

**显示内容**:
- 赛事信息区域显示骨架屏
- 盘口列表区域显示骨架屏
- 赛事统计区域显示骨架屏

**触发条件**:
- 用户首次进入页面
- 用户刷新页面

---

### 加载成功

**描述**: 赛事数据加载成功,正常显示所有内容

**显示内容**:
- 赛事信息组件显示比赛基本信息
- 盘口列表组件显示所有可投注的盘口
- 赛事统计组件显示比赛统计数据
- 历史交锋组件显示历史交锋记录

**交互**:
- 用户可以点击盘口选项添加到投注栏
- 用户可以切换不同的盘口类型
- 用户可以查看不同的统计数据

---

### 加载失败

**描述**: 赛事数据加载失败

**显示内容**:
- 错误提示信息(如"加载失败,请稍后重试")
- "重试"按钮
- 错误图标

**交互**:
- 用户点击"重试"按钮,重新加载数据

**触发条件**:
- 网络错误
- 服务器错误
- 赛事不存在

---

### 盘口关闭

**描述**: 比赛已开始或已结束,盘口关闭

**显示内容**:
- 赛事信息正常显示
- 盘口列表显示"盘口已关闭"提示
- 盘口选项变为灰色,不可点击
- 赛事统计和历史交锋正常显示

**交互**:
- 用户无法点击盘口选项
- 用户可以查看赛事信息和统计数据

**触发条件**:
- 比赛已开始
- 比赛已结束
- 盘口被管理员手动关闭

---

## 交互协同

本节描述页面内组件之间的交互逻辑。

### 点击盘口选项

**触发**: 用户点击"盘口列表"组件中的任意一个盘口选项

**结果**: 
1. "盘口列表"组件将盘口信息传递给"投注栏"组件
2. "投注栏"组件执行"添加注单"操作
3. "投注栏"组件自动展开(如果处于收起状态)
4. "投注栏"组件显示新增的注单
5. "盘口列表"组件中被选中的盘口选项高亮显示

---

### 赔率实时更新

**触发**: WebSocket 接收到赔率变化的消息

**结果**:
1. "盘口列表"组件更新显示的赔率值
2. 如果该盘口已在投注栏中:
   - "投注栏"组件显示"赔率已变化"提示
   - "投注栏"组件高亮显示变化的赔率
   - "投注栏"组件提供"接受新赔率"和"移除注单"选项

---

### 切换盘口类型

**触发**: 用户在"盘口列表"组件中切换盘口类型(如从"胜平负"切换到"让球")

**结果**:
1. "盘口列表"组件更新显示的盘口选项
2. "盘口列表"组件调用 [@获取盘口](../apis/get-odds.md) API 获取新的盘口数据
3. "盘口列表"组件在加载新数据时显示加载动画

---

### 查看赛事统计

**触发**: 用户点击"赛事统计"组件中的不同统计类型(如"球队数据"、"球员数据")

**结果**:
1. "赛事统计"组件切换显示的统计数据
2. "赛事统计"组件调用 [@获取赛事统计](../apis/get-event-stats.md) API 获取新的统计数据
3. "赛事统计"组件在加载新数据时显示加载动画

---

## 调用的 API

本页面调用以下 API:

- [@获取赛事详情](../apis/get-event-detail.md) - 获取赛事的基本信息
- [@获取盘口](../apis/get-odds.md) - 获取赛事的所有盘口选项
- [@获取赛事统计](../apis/get-event-stats.md) - 获取赛事的统计数据
- [@获取历史交锋](../apis/get-head-to-head.md) - 获取两队的历史交锋记录
- [@订阅赔率更新](../apis/subscribe-odds-updates.md) - 订阅赔率实时更新(WebSocket)

---

## 变更历史

| 版本 | 日期 | 作者 | 变更内容 |
|------|------|------|----------|
| 1.2.0 | 2024-01-15 | 张三 | 增加赛事统计和历史交锋功能 |
| 1.1.0 | 2024-01-12 | 张三 | 增加赔率实时更新功能 |
| 1.0.0 | 2024-01-10 | 张三 | 初始版本 |
```

---

## 二、模板填写指南

### 1. 基本信息

填写页面的基本信息,包括页面 ID、路由、状态、负责人等。

**注意**:
- 页面 ID 使用 kebab-case
- 路由使用标准的 URL 路径格式
- 如果路由包含参数,使用 `:paramName` 格式(如 `/events/:eventId`)

---

### 2. 用户故事

使用标准的用户故事格式:

```markdown
**作为** [用户角色]

**我想要** [功能描述]

**以便** [目标/价值]

**验收标准**:
- [标准 1]
- [标准 2]
- [标准 3]
```

**目的**: 让开发者和设计师理解页面的核心价值和功能需求。

---

### 3. 组件装配

列出页面使用的所有组件,并区分页面独有组件和全局组件。

**格式**:
```markdown
- [@组件名](路径) `[标签]` - 简短描述
```

**注意**:
- 使用 `[@组件名](路径)` 格式引用组件
- 全局组件使用 `[全局组件]` 标签
- 普通组件使用 `[组件]` 标签
- 添加简短的功能描述

**分组建议**:
- 将页面独有组件和全局组件分开列出
- 页面独有组件按照在页面中的显示顺序排列

---

### 4. 页面自身状态

仅描述页面**独有内容区域**的状态,不包含全局组件的状态。

**常见的页面自身状态**:
- 加载中
- 加载成功
- 加载失败
- 空状态
- 特殊业务状态(如"盘口关闭"、"活动已结束")

**每个状态需要描述**:
- 描述: 状态的定义
- 显示内容: 在这个状态下页面显示什么
- 交互: 用户可以进行什么操作
- 触发条件: 什么情况下进入这个状态

---

### 5. 交互协同

描述页面内组件之间的交互逻辑。

**格式**:
```markdown
### 交互名称
**触发**: 用户的操作或系统事件
**结果**: 组件的响应和状态变化
```

**注意**:
- 聚焦于组件之间的协同,而不是单个组件内部的交互
- 使用清晰的步骤描述交互流程
- 明确指出哪个组件触发,哪个组件响应

**常见的交互协同场景**:
- 用户点击组件 A,触发组件 B 的状态变化
- 组件 A 接收到数据更新,通知组件 B 更新显示
- 用户在组件 A 中输入,触发组件 B 的验证逻辑

---

### 6. 调用的 API

列出页面调用的所有 API。

**格式**:
```markdown
- [@API 名称](路径) - 简短描述
```

**注意**:
- 使用 `[@API 名称](路径)` 格式引用 API
- 添加简短的功能描述
- 按照调用顺序或重要性排列

---

### 7. 变更历史

使用表格格式记录页面的变更历史。

**格式**:
```markdown
| 版本 | 日期 | 作者 | 变更内容 |
|------|------|------|----------|
| 1.2.0 | 2024-01-15 | 张三 | 增加新功能 |
| 1.1.0 | 2024-01-12 | 张三 | 优化性能 |
| 1.0.0 | 2024-01-10 | 张三 | 初始版本 |
```

**注意**:
- 版本号使用语义化版本(Semantic Versioning)
- 日期格式为 YYYY-MM-DD
- 变更内容简明扼要

---

## 三、页面文档的核心理念

基于 V2.0 方案,页面文档的核心理念是:**聚焦于组件装配和交互协同**。

### 组件是"唯一事实源"

页面文档**不重复描述**组件的详细功能和状态,而是通过引用组件文档来说明页面使用了哪些组件。

**示例**:

❌ **错误做法** - 在页面文档中重复描述组件功能:
```markdown
## 投注栏组件
投注栏是一个全局组件,用于管理用户的投注单。它支持单关和串关两种模式...
(重复了组件文档中的内容)
```

✅ **正确做法** - 通过引用说明使用了哪个组件:
```markdown
## 组件装配
- [@投注栏](../components/bet-slip.md) `[全局组件]` - 管理投注单
```

---

### 页面聚焦于"编排与协同"

页面文档的核心价值在于描述:
1. **组件装配**: 页面使用了哪些组件
2. **页面自身状态**: 页面独有内容区域的状态
3. **交互协同**: 组件之间如何协同工作

**示例**:

✅ **正确做法** - 描述组件之间的协同:
```markdown
### 点击盘口选项
**触发**: 用户点击"盘口列表"中的盘口选项
**结果**: 
1. "盘口列表"将盘口信息传递给"投注栏"
2. "投注栏"执行"添加注单"操作
3. "投注栏"自动展开并显示新增的注单
```

---

### 职责清晰,避免重复

- **组件文档**: 描述组件的功能、状态、属性、交互逻辑
- **页面文档**: 描述页面如何组合组件,组件之间如何协同

这种职责划分避免了文档的重复,降低了维护成本。

---

## 四、常见问题

### Q1: 如果页面有自己的业务逻辑,应该写在哪里?

**A**: 如果页面有独特的业务逻辑(不属于任何组件),应该写在"页面自身状态"或"交互协同"章节。

**示例**: 页面级别的权限控制、页面级别的数据预加载等。

---

### Q2: 全局组件的状态要不要在页面文档中描述?

**A**: 不需要。全局组件的状态应该在组件文档中详细描述,页面文档只需要引用全局组件即可。

**示例**: 投注栏的"空状态"、"单关模式"、"串关模式"等状态应该在投注栏组件文档中描述,而不是在每个使用投注栏的页面文档中重复描述。

---

### Q3: 如果组件在不同页面中的行为不同,怎么办?

**A**: 这种情况有两种处理方式:

**方式 1**: 如果差异较小,在组件文档中描述不同的 Props 配置。

**示例**: 投注栏在不同页面中的位置不同(右侧 vs 底部),通过 `position` 属性控制。

**方式 2**: 如果差异较大,考虑拆分成不同的组件或组件变体。

**示例**: 移动端和桌面端的投注栏差异很大,可以拆分成两个组件。

---

### Q4: 页面调用的 API 和组件调用的 API 有什么区别?

**A**: 
- **页面调用的 API**: 页面级别的数据加载,如获取页面初始数据
- **组件调用的 API**: 组件内部的数据交互,如提交表单、搜索等

**示例**:
- 页面调用 `获取赛事详情` API 来加载页面数据
- 投注栏组件调用 `提交投注` API 来提交投注单

两者都应该在各自的文档中列出。

---

## 五、总结

页面文档模板的核心要点:

✅ **聚焦于组件装配** - 说明页面使用了哪些组件

✅ **聚焦于交互协同** - 说明组件之间如何协同工作

✅ **避免重复** - 不重复描述组件的详细功能

✅ **职责清晰** - 页面文档描述"编排",组件文档描述"功能"

✅ **使用标准格式** - 使用 `[@组件名](路径) `[标签]`` 格式引用组件

使用这个模板将确保页面文档的一致性和清晰性! 📄
