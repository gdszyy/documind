sequenceDiagram
    participant Prematch as Prematch生产者
    participant Client as 客户端系统
    participant LiveOdds as LiveOdds生产者
    participant DB as 本地数据库

    Note over Prematch,LiveOdds: 赛事开始时刻

    Prematch->>Client: odds_change(最终消息)<br/>Market A: status=-2 (Handed Over)<br/>Market B: status=0 (Deactivated)<br/>Market C: status=1 (Active)
    
    Client->>DB: 更新Market A为Handed Over
    Client->>DB: 更新Market B为Deactivated
    Client->>DB: 保持Market C为Active
    
    Client->>Client: Market A: 暂停投注<br/>启动60秒计时器
    Client->>Client: Market B: 灰显
    Client->>Client: Market C: 保持活跃
    
    Note over Client: 等待LiveOdds赔率...

    LiveOdds->>Client: odds_change(LiveOdds)<br/>Market A: status=1 (Active)<br/>赔率更新
    
    Client->>DB: 更新Market A为Active
    Client->>DB: 更新赔率
    Client->>Client: 清除Market A计时器
    Client->>Client: Market A: 恢复投注
    
    Note over Client: 交接完成<br/>正常运行

    alt 60秒超时场景
        Client->>Client: 60秒内未收到<br/>LiveOdds赔率
        Client->>Client: 记录错误
        Client->>Client: 可能需要<br/>人工介入
    end
