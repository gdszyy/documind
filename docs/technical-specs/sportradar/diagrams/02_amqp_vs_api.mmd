---
config:
  layout: elk
---
graph LR
    subgraph AMQP["AMQP Feed (odds_change message)"]
        A1["not_started<br/>(0)"]
        A2["live<br/>(1)"]
        A3["ended<br/>(2)"]
        A4["closed<br/>(3)"]
        
        A1 -->|赔率变化| A2
        A2 -->|赔率变化| A3
        A3 -->|赔率变化| A4
        
        style A1 fill:#e6f3ff
        style A2 fill:#e6f3ff
        style A3 fill:#e6f3ff
        style A4 fill:#e6f3ff
    end
    
    subgraph API["API Endpoint"]
        B1["not_started<br/>(0)"]
        B2["match_about_to_start<br/>(22)"]
        B3["postponed<br/>(60)"]
        B4["delayed<br/>(61)"]
        B5["cancelled<br/>(70)"]
        B6["interrupted<br/>(80)"]
        B7["suspended<br/>(81)"]
        B8["abandoned<br/>(90)"]
        B9["retired<br/>(92)"]
        B10["live"]
        B11["ended<br/>(100)"]
        B12["aet<br/>(110)"]
        B13["match_after_penalties<br/>(120)"]
        B14["closed"]
        
        B1 --> B2
        B2 --> B10
        B1 --> B4
        B1 --> B5
        B10 --> B6
        B6 --> B7
        B7 --> B3
        B10 --> B11
        B11 --> B12
        B11 --> B13
        B11 --> B14
        B10 --> B8
        
        style B1 fill:#fff4e6
        style B10 fill:#e6f3ff
        style B11 fill:#f0e6ff
        style B14 fill:#e6ffe6
        style B3 fill:#ffe6e6
        style B4 fill:#ffe6e6
        style B5 fill:#ffcccc
        style B6 fill:#ffe6e6
        style B7 fill:#ffe6e6
        style B8 fill:#ffe6e6
        style B9 fill:#ffe6e6
        style B2 fill:#fff4e6
        style B12 fill:#f0e6ff
        style B13 fill:#f0e6ff
    end
    
    subgraph Priority["优先级"]
        P1["✓ AMQP优先<br/>实时性强<br/>延迟&lt;几秒"]
        P2["API补充<br/>覆盖完整<br/>可能有延迟"]
        
        style P1 fill:#e6ffe6
        style P2 fill:#fff4e6
    end
    
    AMQP -.->|子集| API
    AMQP --> Priority
    API --> Priority
